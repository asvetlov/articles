Title: Определение главного потока приложения
Labels: python, threading

В многопоточной программе все потоки равны, но один всё же несколько
выделяется.  Это — главный поток.

Главным потоком называется тот, который создаётся при запуске процесса
операционной системой.  Потом программа может наплодить себе разных
потоков на собственные нужды, но главный есть всегда.

Иногда нужно знать, код исполняется в главном потоке или нет.
Например, работать с *UNIX сигналами* можно только из главного потока.
Различные GUI библиотеки часто тоже хотят выполняться непременно в
главном потоке и никаком другом.

Если мы пишем приложение, то всегда можно придумать тот или иной
способ узнать главный поток. Например, при старте, когда других
потоков ещё нет, узнать идентификатор потока через
`threading.get_ident()` и запомнить его где-нибудь.

Когда создаём библиотеку такой способ не всегда подходит.  А в самом
питоне нет официального способа определить, главный поток это или нет.

Зато работают пара хаков.

Тест на *главность* потока:

`isinstance(threading.current_thread(), threading._MainThread)`

Идентификатор главного потока:

`threading._shutdown.__self__.ident`

Используются непубличные механизмы, но это всё же лучше чем ничего.

*P.S.* В Python 3.4 появится функция `threading.main_thread()`, которая
  возвращает объект главного потока. А до тех пор пользуемся хаками.
